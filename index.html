<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carpool Splitter</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Authentication Modal -->
    <div class="auth-overlay" id="authOverlay">
        <div class="auth-modal">
            <div class="auth-header">
                <span class="auth-car">ğŸš—</span>
                <h2>Carpool Splitter</h2>
                <span class="auth-car">ğŸš™</span>
            </div>

            <div class="auth-error" id="authError"></div>

            <!-- Login Form -->
            <form class="auth-form active" id="loginForm" onsubmit="handleLogin(event)">
                <!-- Social Sign In First -->
                <div class="social-buttons-top">
                    <button type="button" class="social-btn google" onclick="handleGoogleSignIn()" title="Sign in with Google">
                        <svg width="20" height="20" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
                        <span>Google</span>
                    </button>
                    <button type="button" class="social-btn apple" onclick="handleAppleSignIn()" title="Sign in with Apple">
                        <span style="font-size: 20px;">ğŸ</span>
                        <span>Apple</span>
                    </button>
                </div>

                <div class="auth-divider-inline">or</div>

                <input type="email" class="auth-input" id="loginEmail" placeholder="Email" required>
                <input type="password" class="auth-input" id="loginPassword" placeholder="Password" required>
                <button type="submit" class="auth-btn" id="loginBtn">Login</button>
                <a href="#" class="forgot-password-link" onclick="showResetPassword(event)">Forgot Password?</a>

                <div class="auth-tabs">
                    <button type="button" class="auth-tab" onclick="switchAuthTab('signup')">Need an account? Sign Up</button>
                </div>
            </form>

            <!-- Sign Up Form -->
            <form class="auth-form" id="signupForm" onsubmit="handleSignup(event)">
                <!-- Social Sign In First -->
                <div class="social-buttons-top">
                    <button type="button" class="social-btn google" onclick="handleGoogleSignIn()" title="Sign in with Google">
                        <svg width="20" height="20" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
                        <span>Google</span>
                    </button>
                    <button type="button" class="social-btn apple" onclick="handleAppleSignIn()" title="Sign in with Apple">
                        <span style="font-size: 20px;">ğŸ</span>
                        <span>Apple</span>
                    </button>
                </div>

                <div class="auth-divider-inline">or</div>

                <input type="email" class="auth-input" id="signupEmail" placeholder="Email" required>
                <input type="password" class="auth-input" id="signupPassword" placeholder="Password (min 6 chars)" required minlength="6">
                <input type="password" class="auth-input" id="signupConfirmPassword" placeholder="Confirm Password" required minlength="6">
                <button type="submit" class="auth-btn" id="signupBtn">Create Account</button>

                <div class="auth-tabs">
                    <button type="button" class="auth-tab" onclick="switchAuthTab('login')">Have an account? Login</button>
                </div>
            </form>

            <!-- Reset Password Form -->
            <form class="auth-form" id="resetForm" onsubmit="handleResetPassword(event)">
                <input type="email" class="auth-input" id="resetEmail" placeholder="Email" required>
                <button type="submit" class="auth-btn" id="resetBtn">Send Reset Link</button>
                <a href="#" class="forgot-password-link" onclick="switchAuthTab('login', event)">Back to Login</a>
            </form>
        </div>
    </div>

    <!-- Cookie Menu -->
    <div class="cookie-menu" id="cookieMenu">
        <button class="cookie-menu-btn menu-share" onclick="shareEvent(); closeCookieMenu();">
            ğŸ”— Share with Friends
        </button>
        <button class="cookie-menu-btn" onclick="randomizeCars(); closeCookieMenu();">
            ğŸ² Randomize Cars
        </button>
        <button class="cookie-menu-btn" onclick="switchTab(3); closeCookieMenu();">
            ğŸ’° Trip Costs
        </button>
        <button class="cookie-menu-btn" id="darkModeToggle" onclick="toggleDarkMode(); closeCookieMenu();">
            <span id="darkModeIcon">ğŸŒ™</span> <span id="darkModeText">Toggle Dark Mode</span>
        </button>
        <button class="cookie-menu-btn menu-logout" onclick="handleLogout()">
            ğŸšª Log Out
        </button>
        <button class="cookie-menu-btn menu-close" onclick="closeCookieMenu()">âœ– Close</button>
    </div>

    <!-- Onboarding Modal for Shared Links -->
    <div class="onboarding-overlay" id="onboardingOverlay">
        <div class="onboarding-modal">
            <h2>ğŸ‰ Join the Carpool!</h2>
            <p id="onboardingEventName" class="onboarding-event-name"></p>

            <div id="onboardingStep1" class="onboarding-step">
                <p class="onboarding-question">Who are you?</p>
                <input type="text" id="onboardingName" class="onboarding-input" placeholder="Your name">
                <p class="onboarding-subtext">Logged in as: <span id="onboardingEmail"></span></p>

                <p class="onboarding-question">Are you driving or riding?</p>
                <div class="onboarding-buttons">
                    <button class="onboarding-btn driver-btn" onclick="selectRole('driver')">ğŸš— I'm Driving</button>
                    <button class="onboarding-btn rider-btn" onclick="selectRole('rider')">ğŸ™‹ I'm Riding</button>
                </div>
            </div>

            <div id="onboardingStep2Driver" class="onboarding-step" style="display: none;">
                <p class="onboarding-question">Set up your car</p>
                <input type="number" id="onboardingSeats" class="onboarding-input" placeholder="How many seats?" min="1" max="20">
                <div class="emoji-picker-mini">
                    <span class="emoji-option" onclick="selectOnboardingEmoji('ğŸš—')">ğŸš—</span>
                    <span class="emoji-option" onclick="selectOnboardingEmoji('ğŸš™')">ğŸš™</span>
                    <span class="emoji-option" onclick="selectOnboardingEmoji('ğŸš•')">ğŸš•</span>
                    <span class="emoji-option" onclick="selectOnboardingEmoji('ğŸš')">ğŸš</span>
                    <span class="emoji-option" onclick="selectOnboardingEmoji('ğŸ›»')">ğŸ›»</span>
                </div>
                <input type="hidden" id="onboardingEmoji" value="ğŸš™">
                <button class="onboarding-btn-primary" onclick="completeDriverOnboarding()">Add My Car</button>
            </div>

            <div id="onboardingStep2Rider" class="onboarding-step" style="display: none;">
                <p class="onboarding-question">Choose a car to join</p>
                <div id="onboardingCarList" class="onboarding-car-list"></div>
                <button class="onboarding-btn-secondary" onclick="skipRiderOnboarding()">I'll decide later</button>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div class="onboarding-overlay" id="shareModal">
        <div class="onboarding-modal" style="max-width: 400px;">
            <button class="close-modal" onclick="closeShareModal()" style="position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 28px; cursor: pointer; color: #999;">Ã—</button>
            <h2>ğŸ“¢ Share Event</h2>
            <p style="color: #666; font-size: 14px; margin-bottom: 20px;">How would you like to share?</p>

            <div style="display: flex; flex-direction: column; gap: 12px;">
                <button onclick="shareViaText()" style="padding: 15px; background: linear-gradient(135deg, #25D366 0%, #128C7E 100%); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 16px; display: flex; align-items: center; justify-content: center; gap: 10px;">
                    ğŸ’¬ Send Text Message
                </button>

                <button onclick="shareViaNative()" style="padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 16px; display: flex; align-items: center; justify-content: center; gap: 10px;">
                    ğŸ“± Share to App
                </button>

                <button onclick="copyShareLink()" style="padding: 15px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 16px; display: flex; align-items: center; justify-content: center; gap: 10px;">
                    ğŸ”— Copy Link
                </button>

                <button onclick="copySummaryText()" style="padding: 15px; background: linear-gradient(135deg, #ff9a56 0%, #ff6b6b 100%); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 16px; display: flex; align-items: center; justify-content: center; gap: 10px;">
                    ğŸ“‹ Copy Summary
                </button>

                <button onclick="addToCalendar()" style="padding: 15px; background: linear-gradient(135deg, #48c6ef 0%, #6f86d6 100%); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 16px; display: flex; align-items: center; justify-content: center; gap: 10px;">
                    ğŸ“… Add to Calendar
                </button>
            </div>

            <p style="color: #999; font-size: 12px; margin-top: 20px; text-align: center;">Anyone with the link can view and join</p>
        </div>
    </div>

    <div class="container">
        <h1>ğŸš— Carpool Splitter ğŸš™</h1>
        <p class="subtitle">Who's riding with who?! ğŸ¤ª</p>

        <!-- View Toggle -->
        <div class="view-toggle-container">
            <button class="view-toggle-btn active" id="simpleViewBtn" onclick="switchToSimpleView()">
                ğŸ‘¶ Simple View
            </button>
            <button class="view-toggle-btn" id="proViewBtn" onclick="switchToProView()">
                ğŸ§  Pro View
            </button>
        </div>

        <!-- Simple View Container -->
        <div id="simpleViewContainer" style="display: none;">
            <div class="simple-view-content">
                <h2 id="simpleEventName" class="simple-event-title">Beach Trip!</h2>

                <div class="simple-event-details">
                    <div class="simple-detail-item">
                        <span class="simple-icon">ğŸ“…</span>
                        <span id="simpleEventDate" class="simple-text">Date not set</span>
                    </div>
                    <div class="simple-detail-item">
                        <span class="simple-icon">ğŸ•</span>
                        <span id="simpleEventTime" class="simple-text">Time not set</span>
                    </div>
                    <div class="simple-detail-item">
                        <span class="simple-icon">ğŸ“</span>
                        <span id="simpleEventLocation" class="simple-text">Location not set</span>
                    </div>
                    <div class="simple-detail-item" id="simpleNotesContainer" style="display: none;">
                        <span class="simple-icon">ğŸ“</span>
                        <span id="simpleEventNotes" class="simple-text"></span>
                    </div>
                </div>

                <div class="simple-your-group">
                    <h3 class="simple-section-title">Your Group</h3>
                    <div id="simpleYourGroup" class="simple-group-card">
                        <div class="simple-group-emoji">ğŸš—</div>
                        <div class="simple-group-info">
                            <div class="simple-group-name">Not assigned yet</div>
                            <div class="simple-group-leader">Tap "I'm In" below to join!</div>
                        </div>
                    </div>
                </div>

                <div class="simple-rsvp-buttons">
                    <button class="simple-btn simple-btn-yes" id="simpleImInBtn" onclick="handleSimpleRSVP('yes')">
                        âœ… I'm In!
                    </button>
                    <button class="simple-btn simple-btn-no" id="simpleCantGoBtn" onclick="handleSimpleRSVP('no')">
                        âŒ Can't Go
                    </button>
                </div>

                <div id="simpleAllGroupsContainer" style="margin-top: 30px;">
                    <h3 class="simple-section-title">All Groups</h3>
                    <div id="simpleAllGroups"></div>
                </div>
            </div>
        </div>

        <!-- Pro View Container -->
        <div id="proViewContainer">
        <input type="text" id="eventName" class="event-input" placeholder="Event Name (e.g., Beach Trip!)">

        <!-- Event Type Selector -->
        <div style="max-width: 400px; margin: 0 auto 15px;">
            <label style="display: block; text-align: center; color: white; font-weight: bold; margin-bottom: 8px; font-size: 14px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">ğŸ“‹ Event Type:</label>
            <select id="eventType" class="event-type-selector" onchange="handleEventTypeChange()">
                <option value="carpool">ğŸš— Carpool (Cars & Drivers)</option>
                <option value="teams">ğŸ³ Teams (Sports, Games, Activities)</option>
                <option value="tables">ğŸ½ï¸ Tables (Dinners, Weddings)</option>
                <option value="lanes">ğŸ³ Lanes (Bowling, Mini Golf)</option>
                <option value="rooms">ğŸšª Rooms (Hotels, Escape Rooms)</option>
                <option value="bus">ğŸšŒ Bus/Shuttle (Large Vehicles)</option>
                <option value="meetup">ğŸš¶ Meetup (Walking Groups)</option>
            </select>
        </div>

        <button id="finalizeBtn" onclick="showFinalizeConfirmation()" style="display: none; width: 100%; max-width: 300px; margin: 10px auto; padding: 10px; background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 14px;">
            âœ… Finalize Carpools
        </button>

        <!-- Dot Navigation Bubbles -->
        <div class="dot-indicators">
            <div class="dot active" onclick="switchTab(0)" id="dot-0"></div>
            <div class="dot" onclick="switchTab(1)" id="dot-1"></div>
            <div class="dot" onclick="switchTab(2)" id="dot-2"></div>
            <div class="dot" onclick="switchTab(3)" id="dot-3"></div>
        </div>

        <!-- Swipeable Container -->
        <div class="swipe-container" id="swipeContainer">
            <!-- TAB 1: Event Details -->
            <div class="tab-content active" id="tab-content-0">
                <!-- Event Details Section -->
        <div class="section event-details-section">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h2 style="margin-bottom: 0;">ğŸ“‹ Event Details</h2>
                <span id="eventStatusPill" class="status-pill status-draft">ğŸ“ Draft</span>
            </div>

            <div class="detail-group">
                <label>ğŸ“… Event Date</label>
                <input type="date" id="eventDate" class="detail-input">
            </div>

            <div class="detail-group">
                <label>ğŸ• Event Time</label>
                <input type="time" id="eventTime" class="detail-input">
            </div>

            <div class="detail-group">
                <label>ğŸ“ Location</label>
                <input type="text" id="eventLocation" class="detail-input" placeholder="e.g., Mission Beach">
            </div>

            <div class="detail-group">
                <label>ğŸ—ºï¸ Address</label>
                <div class="address-group">
                    <input type="text" id="eventAddress" class="detail-input" placeholder="e.g., 123 Ocean Blvd, San Diego, CA">
                    <button type="button" class="maps-btn" onclick="openInMaps()">ğŸ“ Open in Maps</button>
                </div>
            </div>

            <div class="detail-group">
                <label>ğŸ“ Notes</label>
                <textarea id="eventNotes" class="detail-textarea" rows="3" placeholder="e.g., Bring towels, Parking is $20 cash, Leave by 8:15 sharp"></textarea>
            </div>

            <div class="detail-group">
                <label>ğŸ‘¥ Max Attendees</label>
                <input type="number" id="maxAttendees" class="detail-input" placeholder="e.g., 20" min="1" onchange="autoSave(); updateRSVPDisplay();">
            </div>
        </div>

        <!-- RSVP Section -->
        <div class="section rsvp-section">
            <h2 style="margin-bottom: 15px;">ğŸ“‹ RSVP & Headcount</h2>

            <!-- Your RSVP -->
            <div class="your-rsvp-container">
                <p style="font-weight: bold; color: #667eea; margin-bottom: 10px;">Your Status:</p>
                <div class="rsvp-toggle-group">
                    <button class="rsvp-toggle-btn" id="rsvpGoingBtn" onclick="handleRSVP('going')">
                        âœ… Going
                    </button>
                    <button class="rsvp-toggle-btn" id="rsvpMaybeBtn" onclick="handleRSVP('maybe')">
                        ğŸ¤” Maybe
                    </button>
                    <button class="rsvp-toggle-btn" id="rsvpNotGoingBtn" onclick="handleRSVP('not-going')">
                        âŒ Not Going
                    </button>
                </div>
            </div>

            <!-- Headcount Display -->
            <div class="headcount-display">
                <div class="headcount-stat">
                    <div class="headcount-number" id="goingCount">0</div>
                    <div class="headcount-label">Going</div>
                </div>
                <div class="headcount-stat">
                    <div class="headcount-number" id="maybeCount">0</div>
                    <div class="headcount-label">Maybe</div>
                </div>
                <div class="headcount-stat">
                    <div class="headcount-number" id="maxAttendeesDisplay">-</div>
                    <div class="headcount-label">Max</div>
                </div>
            </div>

            <!-- Capacity Warning -->
            <div id="capacityWarning" class="capacity-warning" style="display: none;">
                <span style="font-size: 1.2em;">âš ï¸</span>
                <span>Event is at capacity! New RSVPs will be added to waitlist.</span>
            </div>

            <!-- Waitlist Section -->
            <div id="waitlistSection" style="display: none; margin-top: 20px;">
                <h3 style="color: #667eea; margin-bottom: 10px;">ğŸ“ Waitlist (<span id="waitlistCount">0</span>)</h3>
                <div id="waitlistContainer" class="waitlist-container"></div>
            </div>

            <!-- RSVP Lists -->
            <div class="rsvp-lists">
                <div class="rsvp-list-section">
                    <h3 style="color: #4CAF50;">âœ… Going (<span id="goingListCount">0</span>)</h3>
                    <div id="goingList" class="rsvp-list"></div>
                </div>

                <div class="rsvp-list-section">
                    <h3 style="color: #ff9800;">ğŸ¤” Maybe (<span id="maybeListCount">0</span>)</h3>
                    <div id="maybeList" class="rsvp-list"></div>
                </div>

                <div class="rsvp-list-section">
                    <h3 style="color: #f44336;">âŒ Not Going (<span id="notGoingListCount">0</span>)</h3>
                    <div id="notGoingList" class="rsvp-list"></div>
                </div>
            </div>
        </div>
            </div>
            <!-- End TAB 1 -->

            <!-- TAB 2: Setup (Add Car & Add Friend) -->
            <div class="tab-content" id="tab-content-1">
                <div class="section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h2 style="margin-bottom: 0;">Add Car ğŸš—</h2>
                        <span id="eventStatusPill2" class="status-pill status-draft">ğŸ“ Draft</span>
                    </div>
                    <div class="input-group">
                        <input type="text" id="driverName" placeholder="Driver's name">
                        <input type="number" id="seatCount" placeholder="# of seats" min="1" max="20">
                    </div>

                    <div class="detail-group">
                        <label for="carNickname">ğŸš™ Car Nickname</label>
                        <input type="text" id="carNickname" class="detail-input" placeholder="e.g., The Snack Wagon">
                    </div>

                    <div class="detail-group">
                        <label>ğŸ¨ Choose Icon</label>
                        <div class="emoji-picker-mini" id="mainEmojiPicker">
                            <span class="emoji-option" onclick="selectMainEmoji('ğŸš—')">ğŸš—</span>
                            <span class="emoji-option" onclick="selectMainEmoji('ğŸš™')">ğŸš™</span>
                            <span class="emoji-option" onclick="selectMainEmoji('ğŸš•')">ğŸš•</span>
                            <span class="emoji-option" onclick="selectMainEmoji('ğŸš')">ğŸš</span>
                            <span class="emoji-option" onclick="selectMainEmoji('ğŸ›»')">ğŸ›»</span>
                            <span class="emoji-option" onclick="selectMainEmoji('ğŸš“')">ğŸš“</span>
                        </div>
                    </div>

                    <div class="detail-group">
                        <label>ğŸ¶ Playlist Vibe</label>
                        <select id="playlistVibe" class="detail-input" style="cursor: pointer;">
                            <option value="">No preference</option>
                            <option value="Taylor Swift">Taylor Swift</option>
                            <option value="EDM">EDM</option>
                            <option value="Hip Hop">Hip Hop</option>
                            <option value="Rock">Rock</option>
                            <option value="Country">Country</option>
                            <option value="Podcasts">Podcasts only</option>
                            <option value="Silent">Silent ride</option>
                        </select>
                    </div>

                    <div class="detail-group">
                        <label>ğŸ˜… Energy Level</label>
                        <select id="energyLevel" class="detail-input" style="cursor: pointer;">
                            <option value="">No preference</option>
                            <option value="Chaos">Chaos ğŸ¤ª</option>
                            <option value="Chill">Chill ğŸ˜</option>
                            <option value="Family-friendly">Family-friendly ğŸ‘¨â€ğŸ‘©â€ğŸ‘§</option>
                        </select>
                    </div>

                    <div class="detail-group" style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                        <input type="checkbox" id="singAlong" style="width: auto; cursor: pointer; margin: 0; flex-shrink: 0;">
                        <label for="singAlong" style="margin: 0; cursor: pointer; font-size: 0.9em; white-space: nowrap; flex-shrink: 0;">ğŸ¤ Caraoke Encouraged!</label>
                    </div>

                    <button onclick="addCar()" style="width: 100%; padding: 12px; background: #667eea; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px;">Add Car</button>
                </div>

                <div class="section">
                    <h2>Add Friend ğŸ‘«</h2>
                    <div class="input-group">
                        <input type="text" id="passengerName" placeholder="Friend's nickname">
                        <button onclick="addPassenger()">Add Friend</button>
                    </div>

                    <h3 style="margin-top: 20px; color: #667eea; font-weight: bold;">Unassigned Friends:</h3>
                    <div class="hint-text">ğŸ’¡ Tip: Tap a friend then tap a car to assign them!</div>
                    <div style="display: flex; gap: 10px; margin-bottom: 10px; margin-top: 10px; flex-wrap: wrap;">
                        <button class="auto-assign-btn" onclick="autoFillCars()" style="flex: 1; min-width: 150px; padding: 10px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">âœ¨ Auto-fill Cars</button>
                        <button class="auto-assign-btn" onclick="randomizeCars()" style="flex: 1; min-width: 150px; padding: 10px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">ğŸ² Randomize Cars</button>
                    </div>
                    <div class="unassigned-passengers" id="unassignedList"></div>
                </div>
            </div>
            <!-- End TAB 2 -->

            <!-- TAB 3: Carpool Lineup -->
            <div class="tab-content" id="tab-content-2">
                <div class="section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h2 style="margin-bottom: 0;">Carpool Lineup âœ…</h2>
                        <span id="eventStatusPill3" class="status-pill status-draft">ğŸ“ Draft</span>
                    </div>
                    <div class="cars-container" id="carsContainer"></div>
                </div>
            </div>
            <!-- End TAB 3 -->

            <!-- TAB 4: Trip Costs -->
            <div class="tab-content" id="tab-content-3">
        <div class="section">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h2 style="margin-bottom: 0;">ğŸ’° Trip Costs</h2>
                <span id="eventStatusPill4" class="status-pill status-draft">ğŸ“ Draft</span>
            </div>
            <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Split gas, parking, tolls fairly among passengers</p>

            <div class="detail-group">
                <label>â›½ Gas / Electric Charging (per car)</label>
                <input type="number" id="gasCost" class="detail-input" placeholder="e.g., 40" min="0" step="0.01" onchange="calculateCosts()">
            </div>

            <div class="detail-group">
                <label>ğŸ…¿ï¸ Parking Fee (per car)</label>
                <input type="number" id="parkingFee" class="detail-input" placeholder="e.g., 20" min="0" step="0.01" onchange="calculateCosts()">
            </div>

            <div class="detail-group">
                <label>ğŸ« Tolls / Entry Fees (per car)</label>
                <input type="number" id="tollsFees" class="detail-input" placeholder="e.g., 15" min="0" step="0.01" onchange="calculateCosts()">
            </div>

            <div class="detail-group">
                <label>ğŸ¤ Split Method</label>
                <select id="splitMethod" class="detail-input" onchange="calculateCosts()" style="cursor: pointer;">
                    <option value="passengers-only">Passengers split all costs (Drivers pay nothing)</option>
                    <option value="per-car-gas">Each car's passengers split that car's gas (âš¡ EV-friendly!)</option>
                    <option value="everyone">Everyone splits equally (including drivers)</option>
                    <option value="passengers-gas">Passengers split gas, Everyone splits parking/tolls</option>
                </select>
            </div>

            <div class="detail-group">
                <label>ğŸ’¸ Driver's Venmo (optional)</label>
                <input type="text" id="venmoUsername" class="detail-input" placeholder="e.g., @yourvenmo">
                <p style="font-size: 12px; color: #999; margin-top: 5px;">Add your Venmo for easy payments</p>
            </div>

            <div id="costSummary" style="margin-top: 15px; padding: 15px; background: white; border-radius: 8px; display: none;">
                <h3 style="margin: 0 0 10px 0; color: #667eea;">ğŸ’µ Cost Breakdown</h3>
                <div id="costBreakdownText"></div>
            </div>

            <button onclick="copyGroupChatSummary()" style="width: 100%; margin-top: 15px; padding: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px;">
                ğŸ’¬ Share to Group Chat
            </button>
        </div>
            </div>
            <!-- End TAB 4 -->

        </div>
        <!-- End Swipe Container -->

        <button class="save-btn" onclick="saveData()">âœ… Auto Saved to Cloud</button>
        </div>
        <!-- End Pro View Container -->
    </div>

    <div class="dancing-cookie">ğŸª</div>

    <!-- Toast Notification Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- TETRIS Letter Reveal -->
    <div class="tetris-reveal" id="tetrisReveal"></div>

    <!-- Game Boy Tetris Easter Egg -->
    <div class="gameboy-overlay" id="tetrisOverlay">
        <div class="gameboy">
            <button class="close-tetris" onclick="closeTetris()">Ã—</button>
            <div class="gameboy-screen">
                <canvas id="tetrisCanvas" width="200" height="400" class="tetris-canvas"></canvas>
            </div>
            <div class="gameboy-info">
                <div>SCORE: <span id="tetrisScore">0</span></div>
                <div>LEVEL: <span id="tetrisLevel">1</span></div>
            </div>
            <div class="gameboy-controls">
                â† â†’ Move | â†‘ Rotate | â†“ Drop<br>
                SPACE: Pause
            </div>
        </div>

        <!-- Mobile Touch Controls -->
        <div class="mobile-controls" id="mobileControls">
            <div class="control-row">
                <div class="control-btn" id="btnRotate">â†»</div>
            </div>
            <div class="control-row">
                <div class="control-btn" id="btnLeft">â†</div>
                <div class="control-btn" id="btnDown">â†“</div>
                <div class="control-btn" id="btnRight">â†’</div>
            </div>
        </div>

        <!-- Music Prompt -->
        <div class="music-prompt" id="musicPrompt">ğŸµ Tap any button to start music!</div>
    </div>

    <!-- Hidden Audio Element for 8-bit MP3 -->
    <audio id="mp3Player" loop style="display:none;">
        <source src="the-return-of-the-8-bit-era-301292.mp3" type="audio/mpeg">
    </audio>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script src="app.js"></script>
</body>
</html>
